with recursive fib (n1, n2) as (
  select
    1::double, 1::double
  union all
  select n2, n1+n2
    from fib
  ),
lastdigits as (
  select format('{}', n1)[1]::int as digit
  from fib
  limit 1000                        -- N.B.
  ),
counts as (
  select digit, count() as actual
  from lastdigits group by digit
  ),
total as (
  select count() as total from lastdigits
  )
select digit, actual, (total * log(10, 1 + (1 / digit))) as expected
  from counts, total
  order by digit;
