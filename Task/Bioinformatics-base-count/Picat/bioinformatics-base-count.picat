main =>
  dna(DNA, ChunkSize),
  Count = 0,
  println("Sequence:"),
  Map = new_map(['A'=0,'C'=0,'G'=0,'T'=0]),
  foreach(Chunk in DNA.chunks_of(ChunkSize))
    printf("%4d: %s\n", Count, Chunk),
    Count := Count + Chunk.len,
    foreach(C in Chunk)
      Map.put(C,Map.get(C)+1)
    end
  end,
  println("\nBase count:"),
  foreach(C in "ACGT")
    printf("%5c: %3d\n", C, Map.get(C))
  end,
  printf("Total: %d\n", Count),
  nl.

dna(DNA,ChunkSize) =>
  DNA = "CGTAAAAAATTACAACGTCCTTTGGCTATCTCTTAAACTCCTGCTAAATG
CTCGTGCTTTCCAATTATGTAAGCGTTCCGAGACGGGGTGGTCGATTCTG
AGGACAAAGGTCAAGATGGAGCGCATCGAACGCAATAAGGATCATTTGAT
GGGACGTTTCGTCGACAAAGTCTTGTTTCGAGAGTAACGGCTACCGTCTT
CGATTCTGCTTATAACACTATGTTCTTATGAAATGGATGTTCTGAGTTGG
TCAGTCCCAATGTGCGGGGTTTCTTTTAGTACGTCGGGAGTGGTATTATA
TTTAATTTTTCTATATAGCGATCTGTATTTAAGCAATTCATTTAGGTTAT
CGCCGCGATGCTCGGTTCGGACCGCCAAGCATCTGGCTCCACTGCTAGTG
TCCTAAATTTGAATGGCAAACACAAATAAGATTTAGCAATTCGTGTAGAC
GACCGGGGACTTGCATGATGGGAGCAGCTTTGTTAAACTACGAACGTAAT".delete_all('\n'),
  ChunkSize = 50.
