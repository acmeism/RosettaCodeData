create or replace macro cp(x,y) as (
  select array_agg([a,b] order by ix, iy)
  from (select unnest(x) as a, unnest(range(0, length(x))) as ix),
       (select unnest(y) as b, unnest(range(0, length(y))) as iy)
);

# Example:
select cp([1,2], [3,4]) as product;
