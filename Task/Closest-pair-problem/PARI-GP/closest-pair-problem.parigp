closestPair(v)={
  my(r=norml2(v[1]-v[2]),at=[1,2]);
  for(a=1,#v-1,
    for(b=a+1,#v,
      if(norml2(v[a]-v[b])<r,
        at=[a,b];
        r=norml2(v[a]-v[b])
      )
    )
  );
  [v[at[1]],v[at[2]]]
};
