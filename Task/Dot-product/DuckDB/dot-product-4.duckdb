# Define innerProduct/2 as a scalar function;
# the names of the columns are however fixed.
create or replace function innerProduct(TableA, TableB) as (
  (select * from
    (with
       AT as (from query_table(TableA)),
       BT as (from query_table(TableB))
       select sum(AT.N * BT.N)
       from AT join BT
       on AT.rowid=BT.rowid )
));

select innerProduct('A', 'B');
