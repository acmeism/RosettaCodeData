create or replace function factors(n) as
  list_filter( generate_series(1, sqrt(n)::INT), i -> n % i = 0)
  .list_transform(i -> if (n // i = i, [i], [i, n//i]))
  .flatten()
  .list_sort() ;

## Examples
select n, factors(n) from (select unnest([1,2,3,4,5,6, 45, 53, 64]) as n);
