create or replace function flatten_tuple(tuple) as (
  with cte as
    (select unnest( tuple, recursive:=true)),
  rows as
    (select list_transform( json_keys(j), k -> (j->>k)) as row_values
     from (select cte::json j from cte)
     limit 1)
    select list_filter( (from rows), x -> x is not NULL)
);
