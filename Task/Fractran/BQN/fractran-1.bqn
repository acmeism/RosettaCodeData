# Fractran interpreter

# Helpers
_while_ â† {ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}
ToInt â† 10âŠ¸Ã—âŠ¸+ËœÂ´Â·âŒ½-âŸœ'0'
ToFrac â† {
  i â† âŠ‘/'/'=ğ•©
  ToIntÂ¨i(â†‘â‹ˆ1âŠ¸+âŠ¸â†“)ğ•©
}
Split â† ((Â¬-ËœâŠ¢Ã—Â·+`Â»âŠ¸>)âˆ˜â‰ âŠ”âŠ¢)

Fractran â† {
  ğ•Š nâ€¿numâ€¿den:
  ind â† âŠ‘/0=den|numÃ—n
  âŸ¨(nÃ—indâŠ‘num)Ã·indâŠ‘den â‹„ num â‹„ denâŸ©
}

RunFractran â† {
  steps ğ•Š inpâ€¿prg:
  numâ€¿den â† <Ë˜â‰>ToFracÂ¨' 'Split prg
  step â† 1
  list â† âŸ¨inpâŸ©
  {
    step +â†© 1
    out â† Fractran ğ•©
    list âˆ¾â†© âŠ‘out
    out
  } _while_ {ğ•Š nâ€¿numâ€¿den: (step<steps)âˆ§ âˆ¨Â´0=den|num} inpâ€¿numâ€¿den
  list
}

seq â† 200 RunFractran 2â€¿"17/91 78/85 19/51 23/38 29/33 77/29 95/23 77/19 1/17 11/13 13/11 15/14 15/2 55/1"
â€¢Out "Generated numbers: "âˆ¾â€¢Repr seq
â€¢Out "Primes: "âˆ¾â€¢Repr 1â†“âŒŠ2â‹†â¼(âŒˆ=âŒŠ)âˆ˜(2âŠ¸(â‹†â¼))âŠ¸/ seq
