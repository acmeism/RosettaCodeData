R=: 1 1 3
S=: 0 2 4
FF=: 3 :0
  while. +./y>:R,&#S do.
    R=: R,({:R)+(<:#R){S
    S=: (i.<:+/_2{.R)-.R
  end.
  R;S
)
ffr=: { 0 {:: FF@(>./@,)
ffs=: { 1 {:: FF@(0,>./@,)
