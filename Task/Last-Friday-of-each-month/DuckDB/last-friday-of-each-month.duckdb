create or replace function last_friday(yr, mo) as (
  select dy
  from (select unnest(range(
          extract('day' from last_day(make_date(yr,mo,1))), 1, -1)) as dy )
  where extract('dayofweek' from make_date(yr, mo, dy )) = 5 -- Friday
  limit 1
);

create or replace function last_fridays(yr) as table (
  select yr, mo, last_friday(yr, mo) as dy
  from range(1,13) u(mo)
);

from last_fridays(2012);
