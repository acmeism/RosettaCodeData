10 REM Luhn test of credit card numbers
20 DATA "49927398716", "49927398717", "1234567812345678", "1234567812345670"
30 FOR J = 1 TO 4
40 READ C$: GOSUB 1000
50 PRINT C$;
60 IF RETVAL THEN PRINT " is valid." ELSE PRINT " is invalid."
70 NEXT J
80 END
1000 REM ** Luhn test
1010 S = 0
1020 FOR I = LEN(C$) TO 1 STEP -2
1030 S = S + VAL(MID$(C$, I, 1))
1040 NEXT I
1050 FOR I = LEN(C$) - 1 TO 1 STEP -2
1060 B = VAL(MID$(C$, I, 1)) * 2
1070 IF B >= 10 THEN B = B - 9
1080 S = S + B
1090 NEXT I
1100 RETVAL = (S MOD 10 = 0)
1110 RETURN
