100 PROGRAM "MagicN.bas"
110 DO
120   INPUT PROMPT "The square order: ":N
130 LOOP UNTIL MOD(N,2)>0 AND INT(N)=N AND N>0
140 FOR I=1 TO N
150   FOR J=1 TO N
160     PRINT USING " ###":MOD((I*2-J+N-1),N)*N+MOD(I*2+J-2,N)+1;
170   NEXT
180   PRINT
190 NEXT
200 PRINT "The magic number is:";N*(N^2+1)/2
