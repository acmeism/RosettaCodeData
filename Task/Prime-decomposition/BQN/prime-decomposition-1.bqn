Factor â† { ğ•Šn:
  # Prime sieve
  primes â† â†•0
  Sieve â† { p ğ•Š aâ€¿b:
    p(â‹â†‘âŠ£)â†©âˆšb â‹„ lâ†b-a
    E â† {â†•âˆ˜âŒˆâŒ¾(((ğ•©|-a)+ğ•©Ã—âŠ¢)â¼)l}        # Indices of multiples of ğ•©
    a + / (1â¥ŠËœl) EâŠ¸{0Â¨âŒ¾(ğ•¨âŠ¸âŠ)ğ•©}Â´ p     # Primes in segment [a,b)
  }
  # Factor by trial division
  r â† â†•0                              # Result list
  Try â† {
    m â† (1+âŒŠâˆšn) âŒŠ 2Ã—ğ•©                 # Upper bound for factors this round
    ğ•©<m ?                             # Stop if no factors
    primes âˆ¾â†© np â† primes Sieve ğ•©â€¿m   # New primes
    {0=ğ•©|n? râˆ¾â†©ğ•© â‹„ nÃ·â†©ğ•© â‹„ ğ•Šğ•© ;@}Â¨ np  # Try each one
    ğ•Š m                               # Next segment
  ;@}
  Try 2
  r âˆ¾ 1âŠ¸<âŠ¸â¥Šn
}
