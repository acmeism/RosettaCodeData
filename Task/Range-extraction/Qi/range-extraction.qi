(define make-range
  Start Start -> ["," Start]
  Start End   -> ["," Start "," End] where (= End (+ Start 1))
  Start End   -> ["," Start "-" End])

(define range-extract-0
  Start End []     -> (make-range Start End)
  Start End [A|As] -> (range-extract-0 Start A As) where (= (+ 1 End) A)
  Start End [A|As] -> (append (make-range Start End) (range-extract-0 A A As)))

(define range-extract
  [A |As] -> (FORMAT NIL "狺翎殪蜥铉瀛屮趄徙舡馏┅┅蜥铉瀛屮趄徙北辈贝钡倍狈备惫舶脖膊渤泊驳卜哺补嘲潮巢吵车扯撤掣彻荸