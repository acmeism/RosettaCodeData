create or replace function nthroots(n) as table (
  with twopi as (select 2*pi() as twopi),
  etc as (
    select ((twopi * i) / n) as angle, cos(angle), sin(angle)
    from range(0,n) t(i), twopi
  )
  select COLUMNS(* EXCLUDE (angle))
  from etc
);

from nthroots(10);
