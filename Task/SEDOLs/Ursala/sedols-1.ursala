#import std
#import nat

alphabet = digits-- ~=`A-~r letters
weights  = <1,3,1,7,3,9>
charval  = -:@rlXS num alphabet
iprod    = sum:-0+ product*p/weights+ charval*
checksum = difference/10+ remainder\10+ iprod
