lookup   = -: (^/~& product^|/~& charval)*lsPrK0/weights alphabet
iprod    = sum:-0+ lookup*p/weights
