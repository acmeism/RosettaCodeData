: third  2 pick ;

: >dtriangular ( n -- d )
    dup 1+ m* d2/ ;

: sumdiv ( n m -- d )
    dup >r / >dtriangular r> 1 m*/ ;

: sumdiv_3,5 ( n -- n )
    dup 3 sumdiv third 5 sumdiv d+ rot 15 sumdiv d- ;

: euler1 ( -- n )
    999 sumdiv_3,5 drop ;

: euler1tower ( -- )
    1  \ power of 10
    19 0 DO
        cr dup 19 .r space dup 1- sumdiv_3,5 d.
        10 *
    LOOP drop ;

euler1 . 233168  ok
euler1tower
                  1 0
                 10 23
                100 2318
               1000 233168
              10000 23331668
             100000 2333316668
            1000000 233333166668
           10000000 23333331666668
          100000000 2333333316666668
         1000000000 233333333166666668
        10000000000 23333333331666666668
       100000000000 2333333333316666666668
      1000000000000 233333333333166666666668
     10000000000000 23333333333331666666666668
    100000000000000 2333333333333316666666666668
   1000000000000000 233333333333333166666666666668
  10000000000000000 23333333333333331666666666666668
 100000000000000000 2333333333333333316666666666666668
1000000000000000000 233333333333333333166666666666666668  ok
