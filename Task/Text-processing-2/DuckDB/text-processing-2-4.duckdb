# The values in a struct as JSON values
create or replace function struct_values(s) as (
  with j as (select s::JSON as j)
  SELECT list_transform( json_keys(j), k -> j[k]) from j
);

# Number of nulls in an entire table:
select sum(length(list_filter(struct_values(t), x -> x = 'null'))) as "|null|"
from (select t from t);
