left(n)={
	my(v=[2,3,5,7],u,t=1,out=0);
	for(i=1,n,
		t*=10;
		u=[];
		for(j=1,#v,
			forstep(a=t,t*9,t,
				if(isprime(a+v[j]),u=concat(u,a+v[j]))
			)
		);
		out=v[#v];
		v=vecsort(u)
	);
	out
};
right(n)={
	my(v=[2,3,5,7],u,out=0);
	for(i=1,n,
		u=[];
		for(j=1,#v,
			forstep(a=1,9,[2,4],
				if(isprime(10*v[j]+a),u=concat(u,10*v[j]+a))
			)
		);
		out=v[#v];
		v=u
	);
	out
};
[left(6),right(6)]
